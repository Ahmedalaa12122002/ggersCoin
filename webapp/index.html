<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Croply</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body style="background:#111;color:#fff;text-align:center">

<h2>๐ฑ ูุฑุญุจุงู ุจู</h2>
<p id="status">ุฌุงุฑู ุงูุชุญูู...</p>

<script>
const tg = window.Telegram.WebApp;
tg.ready();

const device_id = localStorage.getItem("device_id") ||
                  (localStorage.setItem("device_id", crypto.randomUUID()),
                   localStorage.getItem("device_id"));

fetch("/api/auth", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({
        initData: tg.initData,
        device_id: device_id
    })
})
.then(r => r.json())
.then(d => {
    if (d.status === "ok") {
        document.getElementById("status").innerText = "โ ุชู ุงูุฏุฎูู ุจูุฌุงุญ";
    } else {
        document.getElementById("status").innerText = d.error;
    }
})
.catch(() => {
    document.getElementById("status").innerText = "โ ุฎุทุฃ ูู ุงูุงุชุตุงู";
});
</script>

</body>
</html>
